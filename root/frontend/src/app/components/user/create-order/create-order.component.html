<div class="page-container">
  <div class="order-form-container">
    <h2>New Order</h2>

    <form #orderForm="ngForm" (ngSubmit)="getRates()">

      <div class="form-columns">
        <!-- Pickup Address -->
        <div class="form-section">
          <h3>Pickup Address</h3>
          <div class="form-group">
            <label>Name</label>
            <input [(ngModel)]="order.address_from.name" name="fromName" required>
          </div>
          <div class="form-group">
            <label>Street</label>
            <input [(ngModel)]="order.address_from.street1" name="fromStreet" required>
          </div>
          <div class="form-group">
            <label>City</label>
            <input [(ngModel)]="order.address_from.city" name="fromCity" required>
          </div>
          <div class="form-group">
            <label>State</label>
            <input [(ngModel)]="order.address_from.state" name="fromState">
          </div>
          <div class="form-group">
            <label>Postal Code</label>
            <input [(ngModel)]="order.address_from.zip" name="fromZip" required>
          </div>
        </div>

        <!-- Delivery Address -->
        <div class="form-section">
          <h3>Delivery Address</h3>
          <div class="form-group">
            <label>Name</label>
            <input [(ngModel)]="order.address_to.name" name="toName" required>
          </div>
          <div class="form-group">
            <label>Street</label>
            <input [(ngModel)]="order.address_to.street1" name="toStreet" required>
          </div>
          <div class="form-group">
            <label>City</label>
            <input [(ngModel)]="order.address_to.city" name="toCity" required>
          </div>
          <div class="form-group">
            <label>State</label>
            <input [(ngModel)]="order.address_to.state" name="toState">
          </div>
          <div class="form-group">
            <label>Postal Code</label>
            <input [(ngModel)]="order.address_to.zip" name="toZip" required>
          </div>
        </div>

        <!-- Parcels -->
        <div class="form-section">
          <h3>Parcels</h3>
          <div *ngFor="let parcel of order.parcels; let i = index" class="form-group parcel-group">
            <label>Weight (kg)</label>
            <input type="number" [(ngModel)]="parcel.weight" [name]="'weight'+i" required>
            <label>Length (cm)</label>
            <input type="number" [(ngModel)]="parcel.length" [name]="'length'+i" required>
            <label>Width (cm)</label>
            <input type="number" [(ngModel)]="parcel.width" [name]="'width'+i" required>
            <label>Height (cm)</label>
            <input type="number" [(ngModel)]="parcel.height" [name]="'height'+i" required>
            <button type="button" (click)="removeParcel(i)" *ngIf="order.parcels.length > 1">Remove</button>
          </div>
          <button type="button" (click)="addParcel()">Add Parcel</button>
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" [disabled]="loading || !orderForm.form.valid">
          {{ loading ? 'Loading...' : 'Get Rates' }}
        </button>
        <button type="button" (click)="loadExample()">Load Example</button>
      </div>

      <div *ngIf="errorMsg" class="error">{{ errorMsg }}</div>
    </form>
  </div>
</div>
